"use strict";(self.webpackChunkRAMN_docs=self.webpackChunkRAMN_docs||[]).push([["163"],{7004:function(e,r,n){n.r(r),n.d(r,{default:()=>a});var s=n(5893),h=n(65);function i(e){let r=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",img:"img",em:"em"},(0,h.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.h1,{id:"固件架构",children:[(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#固件架构",children:"#"}),"固件架构"]}),"\n",(0,s.jsx)(r.p,{children:"ECU A、B、C 和 D 共享一种通用架构，但 ECU A 还启用了 USB 功能。在本页中，我们将详细介绍每个 ECU 的固件架构，首先从较为简单的 ECU B、C 和 D 开始。"}),"\n",(0,s.jsxs)(r.h2,{id:"ecu-bc-和-d",children:[(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#ecu-bc-和-d",children:"#"}),"ECU B、C 和 D"]}),"\n",(0,s.jsx)(r.p,{children:"ECU B、C 和 D 的固件包含六个任务："}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["CAN 接收任务，通过由 CAN-FD 外设中断服务例程 (ISR) 填充的 ",(0,s.jsx)(r.a,{href:"https://www.freertos.org/RTOS-stream-buffer-example.html",rel:"noopener noreferrer",target:"_blank",children:"流缓冲区"}),"接收并处理 CAN 消息。"]}),"\n",(0,s.jsxs)(r.li,{children:["诊断 RX 任务，通过由 CAN 接收任务填充的 ",(0,s.jsx)(r.a,{href:"https://www.freertos.org/RTOS-stream-buffer-example.html",rel:"noopener noreferrer",target:"_blank",children:"流缓冲区"}),"接收并处理完整的（重构的）诊断消息。"]}),"\n",(0,s.jsx)(r.li,{children:"主周期任务，以指定的时间间隔定期执行（通常为 10ms）。该任务负责更新固件中的各个模块。周期性的 CAN 消息传输即由该任务请求。"}),"\n",(0,s.jsx)(r.li,{children:"Diag TX 任务，负责对诊断应答进行分片并发送，同时应用指定的流量控制设置。"}),"\n",(0,s.jsxs)(r.li,{children:["CAN 发送任务，负责发送通过 ",(0,s.jsx)(r.a,{href:"https://www.freertos.org/RTOS-stream-buffer-example.html",rel:"noopener noreferrer",target:"_blank",children:"流缓冲区"}),"请求的 CAN 消息。任何需要通过 CAN 进行通信的任务均可请求发送消息。"]}),"\n",(0,s.jsx)(r.li,{children:"错误处理任务，在需要处理和报告错误时被唤醒。"}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.img,{src:"/firmware/ECUBCD_firmware_architecture.webp",alt:""}),"\r\n",(0,s.jsx)(r.em,{children:"ECU B、C 和 D 固件的架构"})]}),"\n",(0,s.jsxs)(r.h2,{id:"ecu-a",children:[(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#ecu-a",children:"#"}),"ECU A"]}),"\n",(0,s.jsx)(r.p,{children:"ECU A 的固件与 ECU B、C 和 D 完全相同，但额外增加了两项任务："}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"USB 接收任务，用于接收 USB 命令并进行处理；"}),"\n",(0,s.jsxs)(r.li,{children:["USB 发送任务，该任务通过 USB 发送请求的数据（同样，通过 ",(0,s.jsx)(r.a,{href:"https://www.freertos.org/RTOS-stream-buffer-example.html",rel:"noopener noreferrer",target:"_blank",children:"流缓冲区 "}),"）。"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"对于 ECU A，诊断命令也可以通过 USB 而非 CAN 发送。"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.img,{src:"/firmware/ECUA_firmware_architecture.webp",alt:""}),"\r\n",(0,s.jsx)(r.em,{children:"ECU A 固件的架构"})]}),"\n",(0,s.jsxs)(r.h2,{id:"附加任务",children:[(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#附加任务",children:"#"}),"附加任务"]}),"\n",(0,s.jsx)(r.p,{children:"在最新版本中，新增了一些任务，以方便用户轻松实现自定义任务。ECU A 可（可选地）使用这些任务来实现 gs_usb（candlelight）设备。"})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,h.ah)(),e.components);return r?(0,s.jsx)(r,Object.assign({},e,{children:(0,s.jsx)(i,e)})):i(e)}let a=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["docs%2Ffirmware%2Farchitecture.mdx"]={toc:[{id:"ecu-bc-和-d",text:"ECU B、C 和 D",depth:2},{id:"ecu-a",text:"ECU A",depth:2},{id:"附加任务",text:"附加任务",depth:2}],title:"固件架构",headingTitle:"固件架构",frontmatter:{}}}}]);