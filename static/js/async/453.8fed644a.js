"use strict";(self.webpackChunkRAMN_docs=self.webpackChunkRAMN_docs||[]).push([["453"],{1183:function(n,e,s){s.r(e),s.d(e,{default:()=>c});var r=s(5893),i=s(65);function l(n){let e=Object.assign({h1:"h1",a:"a",p:"p",ul:"ul",li:"li",h2:"h2",em:"em",strong:"strong",div:"div",img:"img"},(0,i.ah)(),n.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.h1,{id:"扩展端口",children:[(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#扩展端口",children:"#"}),"扩展端口"]}),"\n",(0,r.jsx)(e.p,{children:"ECU 扩展端口为一个 26 针插座："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"RAMN 主 PCB 主要使用 M20-7831346 连接器（2.54mm 间距，两排各 13 针）。"}),"\n",(0,r.jsx)(e.li,{children:"ECU A 扩展（垂直连接）使用 Amphenol 68021-226HLF 连接器。"}),"\n",(0,r.jsx)(e.li,{children:"ECU B、C 和 D 扩展（水平连接）使用 SAMTEC SSQ-113-03-G-D 连接器（SSQ-113-23-L-D、SSQ-113-23-F-D、SSQ-113-23-T-D 也应兼容）。"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"所有 ECU 共享一套通用的硬件外设配置，因此编程更加简便，且发生配置错误的可能性更低。例如，PA1 引脚始终被配置为 ADC。在底盘扩展中，该引脚连接到方向盘电位器；而在动力总成扩展中，则连接到制动电位器。每个扩展都配备了不同的传感器和电路，但 ECU 仍然共享相同的外设配置。这也意味着二进制输入（如手刹）被当作 ADC 输入处理，而非简单的 GPIO 输入。"}),"\n",(0,r.jsxs)(e.h2,{id:"设计自定义扩展",children:[(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#设计自定义扩展",children:"#"}),"设计自定义扩展"]}),"\n",(0,r.jsxs)(e.p,{children:["您可以使用 SAMTEC SSQ-113-03-G-D 连接器创建可与其他扩展堆叠的新扩展（参见“",(0,r.jsx)(e.a,{href:"/docs/general.html#%E6%89%A9%E5%B1%95",children:"扩展"}),"”部分），但需避免产生冲突。为了快速上手，我们建议您从 ",(0,r.jsx)(e.em,{children:"hardware/V1_revB/5_debugger"})," 文件夹中复制调试器扩展，并使用 ",(0,r.jsx)(e.a,{href:"https://www.kicad.org/",rel:"noopener noreferrer",target:"_blank",children:"KiCAD"})," 进行修改。该扩展采用了可堆叠的 ",(0,r.jsx)(e.strong,{children:"SAMTEC SSQ-113-03-G-D"})," 连接器，并已包含所有可能的信号——只需删除您不需要的部分即可。"]}),"\n",(0,r.jsxs)(e.p,{children:["以下引脚由原始 RAMN 扩展",(0,r.jsx)(e.strong,{children:"主动使用"}),"："]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"**PA1：**ADC（ECU B、C、D）。"}),"\n",(0,r.jsx)(e.li,{children:"**PA4：**ADC（ECU B、C、D）。"}),"\n",(0,r.jsx)(e.li,{children:"PA5：ADC（ECU B、C、D）。"}),"\n",(0,r.jsx)(e.li,{children:"**PB2：**GPIO 输出，SPI2 通信的 CS 引脚（用于 ECU A 的显示屏，或 ECU D 的 LED 驱动器）。"}),"\n",(0,r.jsx)(e.li,{children:"PB12：GPIO 输出，ST7789 显示屏的 DC 引脚（ECU A）或 LED 驱动器的 LE 引脚（ECU D）。"}),"\n",(0,r.jsx)(e.li,{children:"**PB13：**SPI2 SCK（ECU A、D）。"}),"\n",(0,r.jsx)(e.li,{children:"PB14：SPI2 MISO（ECU A）——目前未使用，但保留以备将来使用。"}),"\n",(0,r.jsx)(e.li,{children:"**PB15：**SPI2 MOSI（ECU A、D）。"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["以下引脚始终空闲，",(0,r.jsx)(e.strong,{children:"可用于创建与任何 RAMN ECU 兼容的新扩展"}),"。",(0,r.jsx)(e.strong,{children:"部分引脚已为您预配置，方便使用，但您也可以根据需要自由配置："})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"**PA2：**空闲，预配置为 LPUART1_TX。"}),"\n",(0,r.jsx)(e.li,{children:"**PA3：**空闲，预配置为 LPUART1_RX。"}),"\n",(0,r.jsx)(e.li,{children:"**PA6：**空闲。"}),"\n",(0,r.jsx)(e.li,{children:"**PA7：**空闲。"}),"\n",(0,r.jsx)(e.li,{children:"**PB0：**空闲。"}),"\n",(0,r.jsx)(e.li,{children:"**PB1：**空闲。"}),"\n",(0,r.jsx)(e.li,{children:"**PB10：**空闲，预配置为 I2C2_SCL。"}),"\n",(0,r.jsx)(e.li,{children:"**PB11：**空闲，预配置为 I2C2_SDA。"}),"\n",(0,r.jsx)(e.li,{children:"**PA8：**空闲，预配置为额外的 SPI 片选引脚。"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["尽管 ",(0,r.jsx)(e.strong,{children:"PB13"}),"、",(0,r.jsx)(e.strong,{children:"PB14"})," 和 ",(0,r.jsx)(e.strong,{children:"PB15"})," 已被占用，但 SPI 协议支持复用，因此您也可以将它们用于扩展，但仅限于 SPI 通信。您只需为每个要连接的 SPI 设备分配一个",(0,r.jsx)(e.strong,{children:"不CS PIN"}),"，并复用已定义的 ",(0,r.jsx)(e.strong,{children:"SPI2 SCK（PB13）"}),"、**SPI2 MOSI（PB15）**和 **SPI2 MISO（PB14）**引脚。请注意，对于 ECU A 和 D，您需要共享 SPI 带宽，但可以将原有扩展的带宽限制到最低水平。"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"如果您在选择引脚时需要帮助，请阅读"}),"“",(0,r.jsx)(e.a,{href:"/docs/firmware/customizing_guide.html#%E5%88%9B%E5%BB%BA%E6%96%B0%E6%89%A9%E5%B1%95",children:"创建新扩展"}),"”部分。有关引脚功能，请参阅 ",(0,r.jsx)(e.a,{href:"https://www.st.com/resource/en/datasheet/stm32l552cc.pdf",rel:"noopener noreferrer",target:"_blank",children:"STML552 数据手册"}),"（表 21）。通常，您可以使用以下接口："]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"LPUART1"}),"（UART 接口）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"I2C2"}),"（I2C 接口，主设备或从设备）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"SPI2"}),"（SPI 接口。在 ECU A 和 D 上，必须与现有应用共享总线）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"OCTOSPI1"}),"（非普通 SPI，而是一种通常用于外部闪存的接口）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"ADC"}),"（模数转换器）"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Timers/PWM"}),"（输入或输出）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"GPIO"}),"（输入或输出）。"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"External interrupts"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(e.div,{className:"rspress-directive warning",children:[(0,r.jsx)(e.div,{className:"rspress-directive-title",children:"警告"}),(0,r.jsxs)(e.div,{className:"rspress-directive-content",children:[(0,r.jsxs)(e.p,{children:["尽管大多数接口可以同时使用，但仍存在一些冲突，因此请务必检查兼容性问题（",(0,r.jsx)(e.a,{href:"https://ramn.readthedocs.io/en/latest/firmware/customizing_guide.html#creating-expansion",rel:"noopener noreferrer",target:"_blank",children:"参见创建新扩展"}),"）："]}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"OCTOSPI1 不能与 I2C2 同时使用。"}),"\n",(0,r.jsx)(e.li,{children:"对于 ECU A 和 D，SPI2 只能以主模式使用。"}),"\n",(0,r.jsx)(e.li,{children:"如果希望在 ECU A 上使用（目前未使用的）SD 卡读卡器，则需要将 PB10 用作 SD 卡的 SPI 片选引脚。"}),"\n"]})]})]}),"\n",(0,r.jsxs)(e.p,{children:["如果可用引脚不足，",(0,r.jsx)(e.strong,{children:"可以考虑制作仅兼容单一 ECU 的扩展板"}),"（例如，您可以制作一个重新分配 ",(0,r.jsx)(e.strong,{children:"PA1"}),"、",(0,r.jsx)(e.strong,{children:"PA2"})," 和 ",(0,r.jsx)(e.strong,{children:"PA5"})," 的扩展板，但该扩展板仅与 ECU A 兼容，且您需要为 ECU A 采用不同的外设配置）。"]}),"\n",(0,r.jsxs)(e.div,{className:"rspress-directive warning",children:[(0,r.jsx)(e.div,{className:"rspress-directive-title",children:"警告"}),(0,r.jsx)(e.div,{className:"rspress-directive-content",children:(0,r.jsx)(e.p,{children:"请避免从 3V3 引脚汲取超过几毫安的电流，因为该引脚直接连接到 ECU 的电源，而 ECU 的电源容量有限。相反，应从 5V 引脚获取电源，该引脚直接连接到 USB 5V 线路。"})})]}),"\n",(0,r.jsxs)(e.h2,{id:"引脚排列",children:[(0,r.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#引脚排列",children:"#"}),"引脚排列"]}),"\n",(0,r.jsx)(e.p,{children:"扩展端口的引脚排列如下所示。"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.img,{src:"/hardware/expansions/ecu_socket_pinout.webp",alt:"ECU 扩展端口连接"}),"\r\n",(0,r.jsx)(e.em,{children:"ECU 扩展端口连接"})]}),"\n",(0,r.jsx)(e.p,{children:"所有 ECU 的引脚排列相同，但根据其在电路板上的位置，引脚方向有所不同。请参考以下 KiCAD 截图，以确保引脚方向正确。"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.img,{src:"/hardware/expansions/expansion_A.webp",alt:"ECU A 扩展端口布局"}),"\r\n",(0,r.jsx)(e.em,{children:"ECU A 扩展端口布局"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.img,{src:"/hardware/expansions/expansion_B.webp",alt:"ECU B 扩展端口布局"}),"\r\n",(0,r.jsx)(e.em,{children:"ECU B 扩展端口布局"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.img,{src:"/hardware/expansions/expansion_C.webp",alt:"ECU C 扩展端口布局"}),"\r\n",(0,r.jsx)(e.em,{children:"ECU C 扩展端口布局"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.img,{src:"/hardware/expansions/expansion_D.webp",alt:"ECU D 扩展端口布局"}),"\r\nECU D 扩展端口布局"]})]})}function d(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.ah)(),n.components);return e?(0,r.jsx)(e,Object.assign({},n,{children:(0,r.jsx)(l,n)})):l(n)}let c=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["docs%2Fhardware%2Fexpansions.mdx"]={toc:[{id:"设计自定义扩展",text:"设计自定义扩展",depth:2},{id:"引脚排列",text:"引脚排列",depth:2}],title:"扩展端口",headingTitle:"扩展端口",frontmatter:{}}}}]);